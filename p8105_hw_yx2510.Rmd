---
title: "P8105_hw_yx2510"
author: "Yi Xiao"
date: "28/09/2018"
output: html_document
---
load package
```{r}
library(tidyverse)
library(readxl)
library(magrittr)
```

Problem 1
### 1. read and clean the data
```{r}
nyc_transit_data =
        read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
        janitor::clean_names() %>%
        select(line:entry,vending, ada)

nyc_transit_data$entry = ifelse(nyc_transit_data$entry == "yes", TRUE, FALSE)
str(nyc_transit_data)
```
After importing the file using read_csv() function, I found that there are upper cases and spaces in the variable names, so I first use the clean_name() for the name cleaning. Then I used the select() function to include those variables we are interested in. At last, ifelse() was used to convert the entry status to corresponding logical variables. 

I used str() to give an overview of the data. Some important variables includes line, station name, latitide and longitude of their locations, routes they take, entry type, whether vending and entry are ADA compliant. There were `r ncol(nyc_transit_data)` columns and `r nrow(nyc_transit_data)` rows. However, the dataset is not tidy since the route information was scattered across several colunms. Hence, data cleaning is required to gather the information in a single column.

* There are `r nrow(distinct(nyc_transit_data, line, station_name))` staions in the data.

* There are `r nrow(filter(distinct(nyc_transit_data, line, station_name, ada), ada ==  TRUE))` ADA compliant stations.

* There are `r 100 * round(nrow(filter(nyc_transit_data, vending == "NO"))/nrow(nyc_transit_data), 4)`% of exit/entry
witout pending allow entry.

### 2. data tidying 
In this code chunk, I reformated data so that route number and route name are distinct variables.
```{r}
nyc_transit_tidy_data = gather(nyc_transit_data, key = route, value = route_number, route1: route11)

```
* There are `r nrow(filter(distinct(nyc_transit_tidy_data, line, station_name, route_number), route_number == "A" ))` 
distinct stations serve A.

* Of the stations serve A train, there are `r nrow(filter(distinct(nyc_transit_tidy_data, line, 
station_name, route_number, ada), route_number == "A" & ada == "TRUE" ))` ADA compliant stations.

Problem 2
### 1. read and clean Mr Trash wheel data
```{r}
 trash_wheel_data = readxl::read_xlsx("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
                     sheet = "Mr. Trash Wheel", 
                     range = "A2:N258")  %>%
                     janitor::clean_names()  %>%
                     filter(!dumpster)  %>%
                     mutate(sports_balls = round(sports_balls, digits = 0)) %>% 
                     mutate(sports_balls = as.integer(sports_balls))
trash_wheel_data
```
### 2. read and clean 2016 and 2017 precipitation data
```{r}
prcp_16_data =
  readxl::read_xlsx("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
             sheet = "2016 Precipitation", 
             range = "A2:B14") %>%
  janitor::clean_names() %>%
  filter(!is.na(total)) %>% 
  mutate(year = 2016)

prcp_17_data =
  readxl::read_xlsx("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", 
             sheet = "2017 Precipitation", 
             range = "A2:B14") %>%
  janitor::clean_names() %>%
  filter(!is.na(total)) %>% 
  mutate(year = 2017)
```


### 3. combine the data
```{r}
prcp_comb = full_join(prcp_16_data, prcp_17_data, by = c("month", "total")) %>%
mutate(month = month.name[month])
```


Problem 3



